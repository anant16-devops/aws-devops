{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.206.0"},"children":{"NetworkStack":{"id":"NetworkStack","path":"NetworkStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.206.0"},"children":{"AppVPC":{"id":"AppVPC","path":"NetworkStack/AppVPC","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.Vpc","version":"2.206.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"NetworkStack/AppVPC/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPC","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPC","aws:cdk:cloudformation:props":{"cidrBlock":"10.0.0.0/16","enableDnsHostnames":true,"enableDnsSupport":true,"instanceTenancy":"default","tags":[{"key":"Name","value":"NetworkStack/AppVPC"}]}}},"publicSubnet1":{"id":"publicSubnet1","path":"NetworkStack/AppVPC/publicSubnet1","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PublicSubnet","version":"2.206.0","metadata":[]},"children":{"Subnet":{"id":"Subnet","path":"NetworkStack/AppVPC/publicSubnet1/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":"eu-north-1a","cidrBlock":"10.0.0.0/17","mapPublicIpOnLaunch":true,"tags":[{"key":"aws-cdk:subnet-name","value":"public"},{"key":"aws-cdk:subnet-type","value":"Public"},{"key":"Name","value":"NetworkStack/AppVPC/publicSubnet1"}],"vpcId":{"Ref":"AppVPCB7733741"}}}},"Acl":{"id":"Acl","path":"NetworkStack/AppVPC/publicSubnet1/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.206.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"NetworkStack/AppVPC/publicSubnet1/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"NetworkStack/AppVPC/publicSubnet1"}],"vpcId":{"Ref":"AppVPCB7733741"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"NetworkStack/AppVPC/publicSubnet1/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"AppVPCpublicSubnet1RouteTable7AF09E37"},"subnetId":{"Ref":"AppVPCpublicSubnet1SubnetE8E07292"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"NetworkStack/AppVPC/publicSubnet1/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","gatewayId":{"Ref":"AppVPCIGW7D765419"},"routeTableId":{"Ref":"AppVPCpublicSubnet1RouteTable7AF09E37"}}}}}},"publicSubnet2":{"id":"publicSubnet2","path":"NetworkStack/AppVPC/publicSubnet2","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PublicSubnet","version":"2.206.0","metadata":[]},"children":{"Subnet":{"id":"Subnet","path":"NetworkStack/AppVPC/publicSubnet2/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":"eu-north-1b","cidrBlock":"10.0.128.0/17","mapPublicIpOnLaunch":true,"tags":[{"key":"aws-cdk:subnet-name","value":"public"},{"key":"aws-cdk:subnet-type","value":"Public"},{"key":"Name","value":"NetworkStack/AppVPC/publicSubnet2"}],"vpcId":{"Ref":"AppVPCB7733741"}}}},"Acl":{"id":"Acl","path":"NetworkStack/AppVPC/publicSubnet2/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.206.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"NetworkStack/AppVPC/publicSubnet2/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"NetworkStack/AppVPC/publicSubnet2"}],"vpcId":{"Ref":"AppVPCB7733741"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"NetworkStack/AppVPC/publicSubnet2/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"AppVPCpublicSubnet2RouteTableB41C9C7E"},"subnetId":{"Ref":"AppVPCpublicSubnet2Subnet69A67A34"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"NetworkStack/AppVPC/publicSubnet2/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","gatewayId":{"Ref":"AppVPCIGW7D765419"},"routeTableId":{"Ref":"AppVPCpublicSubnet2RouteTableB41C9C7E"}}}}}},"IGW":{"id":"IGW","path":"NetworkStack/AppVPC/IGW","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnInternetGateway","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::InternetGateway","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"NetworkStack/AppVPC"}]}}},"VPCGW":{"id":"VPCGW","path":"NetworkStack/AppVPC/VPCGW","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCGatewayAttachment","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCGatewayAttachment","aws:cdk:cloudformation:props":{"internetGatewayId":{"Ref":"AppVPCIGW7D765419"},"vpcId":{"Ref":"AppVPCB7733741"}}}}}},"AppSG":{"id":"AppSG","path":"NetworkStack/AppSG","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.206.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"NetworkStack/AppSG/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"Allow SSH and HTTP","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"securityGroupIngress":[{"cidrIp":"0.0.0.0/0","ipProtocol":"tcp","fromPort":22,"toPort":22,"description":"SSH Access"},{"cidrIp":"0.0.0.0/0","ipProtocol":"tcp","fromPort":80,"toPort":80,"description":"HTTP Access"}],"vpcId":{"Ref":"AppVPCB7733741"}}}}}},"EC2Role":{"id":"EC2Role","path":"NetworkStack/EC2Role","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.206.0","metadata":[]},"children":{"ImportEC2Role":{"id":"ImportEC2Role","path":"NetworkStack/EC2Role/ImportEC2Role","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.206.0","metadata":[]}},"Resource":{"id":"Resource","path":"NetworkStack/EC2Role/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"ec2.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/AmazonEC2ContainerRegistryReadOnly"]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/AmazonSSMManagedInstanceCore"]]}]}}}}},"AppInstance":{"id":"AppInstance","path":"NetworkStack/AppInstance","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.Instance","version":"2.206.0","metadata":[]},"children":{"InstanceProfile":{"id":"InstanceProfile","path":"NetworkStack/AppInstance/InstanceProfile","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnInstanceProfile","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::InstanceProfile","aws:cdk:cloudformation:props":{"roles":[{"Ref":"EC2RoleF978FC1C"}]}}},"Resource":{"id":"Resource","path":"NetworkStack/AppInstance/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnInstance","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Instance","aws:cdk:cloudformation:props":{"availabilityZone":"eu-north-1a","iamInstanceProfile":{"Ref":"AppInstanceInstanceProfileC6B6EFAA"},"imageId":{"Ref":"SsmParameterValueawsserviceamiamazonlinuxlatestamznamihvmx8664gp2C96584B6F00A464EAD1953AFF4B05118Parameter"},"instanceType":"t3.micro","securityGroupIds":[{"Fn::GetAtt":["AppSG652848D9","GroupId"]}],"subnetId":{"Ref":"AppVPCpublicSubnet1SubnetE8E07292"},"tags":[{"key":"Name","value":"NetworkStack/AppInstance"}],"userData":{"Fn::Base64":"#!/bin/bash\nyum update -y\namazon-linux-extras install docker -y\nservice docker start\nusermod -a -G docker ec2-user\ndocker pull 837217115905.dkr.ecr.eu-north-1.amazonaws.com/my-flask-app:latest\ndocker run -d -p 80:80 837217115905.dkr.ecr.eu-north-1.amazonaws.com/my-flask-app:latest"}}}}}},"SsmParameterValue:--aws--service--ami-amazon-linux-latest--amzn-ami-hvm-x86_64-gp2:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter":{"id":"SsmParameterValue:--aws--service--ami-amazon-linux-latest--amzn-ami-hvm-x86_64-gp2:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter","path":"NetworkStack/SsmParameterValue:--aws--service--ami-amazon-linux-latest--amzn-ami-hvm-x86_64-gp2:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.206.0"}},"SsmParameterValue:--aws--service--ami-amazon-linux-latest--amzn-ami-hvm-x86_64-gp2:C96584B6-F00A-464E-AD19-53AFF4B05118":{"id":"SsmParameterValue:--aws--service--ami-amazon-linux-latest--amzn-ami-hvm-x86_64-gp2:C96584B6-F00A-464E-AD19-53AFF4B05118","path":"NetworkStack/SsmParameterValue:--aws--service--ami-amazon-linux-latest--amzn-ami-hvm-x86_64-gp2:C96584B6-F00A-464E-AD19-53AFF4B05118","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.206.0","metadata":[]}},"CDKMetadata":{"id":"CDKMetadata","path":"NetworkStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"NetworkStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.206.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"NetworkStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.206.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"NetworkStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.206.0"}}}},"EcrStack":{"id":"EcrStack","path":"EcrStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.206.0"},"children":{"FlaskAppRepo":{"id":"FlaskAppRepo","path":"EcrStack/FlaskAppRepo","constructInfo":{"fqn":"aws-cdk-lib.aws_ecr.Repository","version":"2.206.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EcrStack/FlaskAppRepo/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ecr.CfnRepository","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ECR::Repository","aws:cdk:cloudformation:props":{"repositoryName":"flask-nginx-app"}}}}},"CDKMetadata":{"id":"CDKMetadata","path":"EcrStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"EcrStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.206.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"EcrStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.206.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"EcrStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.206.0"}}}},"DeployStack":{"id":"DeployStack","path":"DeployStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.206.0"},"children":{"CodeDeployServiceRole":{"id":"CodeDeployServiceRole","path":"DeployStack/CodeDeployServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.206.0","metadata":[]},"children":{"ImportCodeDeployServiceRole":{"id":"ImportCodeDeployServiceRole","path":"DeployStack/CodeDeployServiceRole/ImportCodeDeployServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.206.0","metadata":[]}},"Resource":{"id":"Resource","path":"DeployStack/CodeDeployServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"codedeploy.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSCodeDeployRole"]]}]}}}}},"FlaskAppDeployApp":{"id":"FlaskAppDeployApp","path":"DeployStack/FlaskAppDeployApp","constructInfo":{"fqn":"aws-cdk-lib.aws_codedeploy.ServerApplication","version":"2.206.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DeployStack/FlaskAppDeployApp/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_codedeploy.CfnApplication","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CodeDeploy::Application","aws:cdk:cloudformation:props":{"applicationName":"FlaskAppEC2DeployApp","computePlatform":"Server"}}}}},"FlaskAppDeployGroup":{"id":"FlaskAppDeployGroup","path":"DeployStack/FlaskAppDeployGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_codedeploy.ServerDeploymentGroup","version":"2.206.0","metadata":[]},"children":{"Bucket":{"id":"Bucket","path":"DeployStack/FlaskAppDeployGroup/Bucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.206.0","metadata":[]}},"Resource":{"id":"Resource","path":"DeployStack/FlaskAppDeployGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_codedeploy.CfnDeploymentGroup","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CodeDeploy::DeploymentGroup","aws:cdk:cloudformation:props":{"applicationName":{"Ref":"FlaskAppDeployApp0250C340"},"autoRollbackConfiguration":{"enabled":true,"events":["DEPLOYMENT_FAILURE"]},"deploymentConfigName":"CodeDeployDefault.AllAtOnce","deploymentGroupName":"FlaskAppEC2Group","ec2TagSet":{"ec2TagSetList":[{"ec2TagGroup":[{"key":"Name","value":"FlaskAppEC2","type":"KEY_AND_VALUE"}]}]},"serviceRoleArn":{"Fn::GetAtt":["CodeDeployServiceRole897ED2CE","Arn"]}}}}}},"CDKMetadata":{"id":"CDKMetadata","path":"DeployStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"DeployStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.206.0"}}}},"Exports":{"id":"Exports","path":"DeployStack/Exports","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Output{\"Ref\":\"FlaskAppDeployApp0250C340\"}":{"id":"Output{\"Ref\":\"FlaskAppDeployApp0250C340\"}","path":"DeployStack/Exports/Output{\"Ref\":\"FlaskAppDeployApp0250C340\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.206.0"}},"Output{\"Ref\":\"FlaskAppDeployGroup4B8BC649\"}":{"id":"Output{\"Ref\":\"FlaskAppDeployGroup4B8BC649\"}","path":"DeployStack/Exports/Output{\"Ref\":\"FlaskAppDeployGroup4B8BC649\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.206.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"DeployStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.206.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"DeployStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.206.0"}}}},"PipelineStack":{"id":"PipelineStack","path":"PipelineStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.206.0"},"children":{"ArtifactsBucket":{"id":"ArtifactsBucket","path":"PipelineStack/ArtifactsBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.206.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"PipelineStack/ArtifactsBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"versioningConfiguration":{"status":"Enabled"}}}}}},"CodeBuildRole":{"id":"CodeBuildRole","path":"PipelineStack/CodeBuildRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.206.0","metadata":[]},"children":{"ImportCodeBuildRole":{"id":"ImportCodeBuildRole","path":"PipelineStack/CodeBuildRole/ImportCodeBuildRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.206.0","metadata":[]}},"Resource":{"id":"Resource","path":"PipelineStack/CodeBuildRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"codebuild.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/AmazonEC2ContainerRegistryPowerUser"]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/AmazonS3ReadOnlyAccess"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"PipelineStack/CodeBuildRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.206.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"PipelineStack/CodeBuildRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["ArtifactsBucket2AAC5544","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["ArtifactsBucket2AAC5544","Arn"]},"/*"]]}]},{"Action":["logs:CreateLogGroup","logs:CreateLogStream","logs:PutLogEvents"],"Effect":"Allow","Resource":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":logs:eu-north-1:837217115905:log-group:/aws/codebuild/",{"Ref":"FlaskAppDockerBuild77E71840"}]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":logs:eu-north-1:837217115905:log-group:/aws/codebuild/",{"Ref":"FlaskAppDockerBuild77E71840"},":*"]]}]},{"Action":["codebuild:CreateReportGroup","codebuild:CreateReport","codebuild:UpdateReport","codebuild:BatchPutTestCases","codebuild:BatchPutCodeCoverages"],"Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":codebuild:eu-north-1:837217115905:report-group/",{"Ref":"FlaskAppDockerBuild77E71840"},"-*"]]}}],"Version":"2012-10-17"},"policyName":"CodeBuildRoleDefaultPolicy829527DE","roles":[{"Ref":"CodeBuildRole728CBADE"}]}}}}}}},"FlaskAppDockerBuild":{"id":"FlaskAppDockerBuild","path":"PipelineStack/FlaskAppDockerBuild","constructInfo":{"fqn":"aws-cdk-lib.aws_codebuild.Project","version":"2.206.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"PipelineStack/FlaskAppDockerBuild/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_codebuild.CfnProject","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CodeBuild::Project","aws:cdk:cloudformation:props":{"artifacts":{"type":"S3","location":{"Ref":"ArtifactsBucket2AAC5544"},"path":"build-artifacts","namespaceType":"BUILD_ID","packaging":"ZIP","overrideArtifactName":true},"cache":{"type":"NO_CACHE"},"encryptionKey":"alias/aws/s3","environment":{"type":"LINUX_CONTAINER","image":"aws/codebuild/standard:7.0","imagePullCredentialsType":"CODEBUILD","privilegedMode":true,"computeType":"BUILD_GENERAL1_SMALL","environmentVariables":[{"name":"AWS_DEFAULT_REGION","type":"PLAINTEXT","value":"eu-north-1"},{"name":"AWS_ACCOUNT_ID","type":"PLAINTEXT","value":"837217115905"},{"name":"REPOSITORY_URI","type":"PLAINTEXT","value":"837217115905.dkr.ecr.eu-north-1.amazonaws.com/flask-nginx-app"}]},"serviceRole":{"Fn::GetAtt":["CodeBuildRole728CBADE","Arn"]},"source":{"type":"GITHUB","reportBuildStatus":true,"location":"https://github.com/anant16-devops/aws-devops.git","buildSpec":"buildspec.yml"}}}}}},"FlaskAppPipeline":{"id":"FlaskAppPipeline","path":"PipelineStack/FlaskAppPipeline","constructInfo":{"fqn":"aws-cdk-lib.aws_codepipeline.Pipeline","version":"2.206.0","metadata":[]},"children":{"Role":{"id":"Role","path":"PipelineStack/FlaskAppPipeline/Role","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.206.0","metadata":[]},"children":{"ImportRole":{"id":"ImportRole","path":"PipelineStack/FlaskAppPipeline/Role/ImportRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.206.0","metadata":[]}},"Resource":{"id":"Resource","path":"PipelineStack/FlaskAppPipeline/Role/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"codepipeline.amazonaws.com"}}],"Version":"2012-10-17"}}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"PipelineStack/FlaskAppPipeline/Role/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.206.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"PipelineStack/FlaskAppPipeline/Role/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["ArtifactsBucket2AAC5544","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["ArtifactsBucket2AAC5544","Arn"]},"/*"]]}]},{"Action":"sts:AssumeRole","Effect":"Allow","Resource":{"Fn::GetAtt":["FlaskAppPipelineBuildDockerBuildandPushCodePipelineActionRole67DE4019","Arn"]}},{"Action":"sts:AssumeRole","Effect":"Allow","Resource":{"Fn::GetAtt":["FlaskAppPipelineDeployCodeDeployEC2CodePipelineActionRoleA204F468","Arn"]}}],"Version":"2012-10-17"},"policyName":"FlaskAppPipelineRoleDefaultPolicy653C09BF","roles":[{"Ref":"FlaskAppPipelineRole780B808B"}]}}}}}}},"Resource":{"id":"Resource","path":"PipelineStack/FlaskAppPipeline/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_codepipeline.CfnPipeline","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CodePipeline::Pipeline","aws:cdk:cloudformation:props":{"artifactStore":{"type":"S3","location":{"Ref":"ArtifactsBucket2AAC5544"}},"name":"FlaskAppDockerPipeline","roleArn":{"Fn::GetAtt":["FlaskAppPipelineRole780B808B","Arn"]},"stages":[{"name":"Source","actions":[{"name":"GitHub_Source","outputArtifacts":[{"name":"SourceOutput"}],"actionTypeId":{"category":"Source","version":"1","owner":"ThirdParty","provider":"GitHub"},"configuration":{"Owner":"anant16-devops","Repo":"aws-devops","Branch":"main","OAuthToken":"{{resolve:secretsmanager:my-github-token:SecretString:::}}","PollForSourceChanges":false},"runOrder":1}]},{"name":"Build","actions":[{"name":"Docker_Build_and_Push","inputArtifacts":[{"name":"SourceOutput"}],"outputArtifacts":[{"name":"BuildOutput"}],"actionTypeId":{"category":"Build","version":"1","owner":"AWS","provider":"CodeBuild"},"configuration":{"ProjectName":{"Ref":"FlaskAppDockerBuild77E71840"}},"runOrder":1,"roleArn":{"Fn::GetAtt":["FlaskAppPipelineBuildDockerBuildandPushCodePipelineActionRole67DE4019","Arn"]}}]},{"name":"Deploy","actions":[{"name":"CodeDeploy_EC2","inputArtifacts":[{"name":"BuildOutput"}],"actionTypeId":{"category":"Deploy","version":"1","owner":"AWS","provider":"CodeDeploy"},"configuration":{"ApplicationName":{"Fn::ImportValue":"DeployStack:ExportsOutputRefFlaskAppDeployApp0250C34037A17271"},"DeploymentGroupName":{"Fn::ImportValue":"DeployStack:ExportsOutputRefFlaskAppDeployGroup4B8BC6493FD18F61"}},"runOrder":1,"roleArn":{"Fn::GetAtt":["FlaskAppPipelineDeployCodeDeployEC2CodePipelineActionRoleA204F468","Arn"]}}]}]}}},"Source":{"id":"Source","path":"PipelineStack/FlaskAppPipeline/Source","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"GitHub_Source":{"id":"GitHub_Source","path":"PipelineStack/FlaskAppPipeline/Source/GitHub_Source","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"WebhookResource":{"id":"WebhookResource","path":"PipelineStack/FlaskAppPipeline/Source/GitHub_Source/WebhookResource","constructInfo":{"fqn":"aws-cdk-lib.aws_codepipeline.CfnWebhook","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CodePipeline::Webhook","aws:cdk:cloudformation:props":{"authentication":"GITHUB_HMAC","authenticationConfiguration":{"secretToken":"{{resolve:secretsmanager:my-github-token:SecretString:::}}"},"filters":[{"jsonPath":"$.ref","matchEquals":"refs/heads/{Branch}"}],"registerWithThirdParty":true,"targetAction":"GitHub_Source","targetPipeline":{"Ref":"FlaskAppPipelineA2C66A85"},"targetPipelineVersion":1}}}}}}},"Build":{"id":"Build","path":"PipelineStack/FlaskAppPipeline/Build","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Docker_Build_and_Push":{"id":"Docker_Build_and_Push","path":"PipelineStack/FlaskAppPipeline/Build/Docker_Build_and_Push","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"CodePipelineActionRole":{"id":"CodePipelineActionRole","path":"PipelineStack/FlaskAppPipeline/Build/Docker_Build_and_Push/CodePipelineActionRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.206.0","metadata":[]},"children":{"ImportCodePipelineActionRole":{"id":"ImportCodePipelineActionRole","path":"PipelineStack/FlaskAppPipeline/Build/Docker_Build_and_Push/CodePipelineActionRole/ImportCodePipelineActionRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.206.0","metadata":[]}},"Resource":{"id":"Resource","path":"PipelineStack/FlaskAppPipeline/Build/Docker_Build_and_Push/CodePipelineActionRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["FlaskAppPipelineRole780B808B","Arn"]}}}],"Version":"2012-10-17"}}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"PipelineStack/FlaskAppPipeline/Build/Docker_Build_and_Push/CodePipelineActionRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.206.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"PipelineStack/FlaskAppPipeline/Build/Docker_Build_and_Push/CodePipelineActionRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["codebuild:BatchGetBuilds","codebuild:StartBuild","codebuild:StopBuild"],"Effect":"Allow","Resource":{"Fn::GetAtt":["FlaskAppDockerBuild77E71840","Arn"]}}],"Version":"2012-10-17"},"policyName":"FlaskAppPipelineBuildDockerBuildandPushCodePipelineActionRoleDefaultPolicyAF96CD37","roles":[{"Ref":"FlaskAppPipelineBuildDockerBuildandPushCodePipelineActionRole67DE4019"}]}}}}}}}}}}},"Deploy":{"id":"Deploy","path":"PipelineStack/FlaskAppPipeline/Deploy","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"CodeDeploy_EC2":{"id":"CodeDeploy_EC2","path":"PipelineStack/FlaskAppPipeline/Deploy/CodeDeploy_EC2","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"CodePipelineActionRole":{"id":"CodePipelineActionRole","path":"PipelineStack/FlaskAppPipeline/Deploy/CodeDeploy_EC2/CodePipelineActionRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.206.0","metadata":[]},"children":{"ImportCodePipelineActionRole":{"id":"ImportCodePipelineActionRole","path":"PipelineStack/FlaskAppPipeline/Deploy/CodeDeploy_EC2/CodePipelineActionRole/ImportCodePipelineActionRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.206.0","metadata":[]}},"Resource":{"id":"Resource","path":"PipelineStack/FlaskAppPipeline/Deploy/CodeDeploy_EC2/CodePipelineActionRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["FlaskAppPipelineRole780B808B","Arn"]}}}],"Version":"2012-10-17"}}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"PipelineStack/FlaskAppPipeline/Deploy/CodeDeploy_EC2/CodePipelineActionRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.206.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"PipelineStack/FlaskAppPipeline/Deploy/CodeDeploy_EC2/CodePipelineActionRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.206.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["codedeploy:GetApplicationRevision","codedeploy:RegisterApplicationRevision"],"Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":codedeploy:eu-north-1:837217115905:application:",{"Fn::ImportValue":"DeployStack:ExportsOutputRefFlaskAppDeployApp0250C34037A17271"}]]}},{"Action":["codedeploy:CreateDeployment","codedeploy:GetDeployment"],"Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":codedeploy:eu-north-1:837217115905:deploymentgroup:",{"Fn::ImportValue":"DeployStack:ExportsOutputRefFlaskAppDeployApp0250C34037A17271"},"/",{"Fn::ImportValue":"DeployStack:ExportsOutputRefFlaskAppDeployGroup4B8BC6493FD18F61"}]]}},{"Action":"codedeploy:GetDeploymentConfig","Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":codedeploy:eu-north-1:837217115905:deploymentconfig:CodeDeployDefault.AllAtOnce"]]}},{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["ArtifactsBucket2AAC5544","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["ArtifactsBucket2AAC5544","Arn"]},"/*"]]}]}],"Version":"2012-10-17"},"policyName":"FlaskAppPipelineDeployCodeDeployEC2CodePipelineActionRoleDefaultPolicyCFF5FA8F","roles":[{"Ref":"FlaskAppPipelineDeployCodeDeployEC2CodePipelineActionRoleA204F468"}]}}}}}}}}}}}}},"CDKMetadata":{"id":"CDKMetadata","path":"PipelineStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"PipelineStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.206.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"PipelineStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.206.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"PipelineStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.206.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}